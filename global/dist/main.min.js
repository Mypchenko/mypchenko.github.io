"use strict";var globalObj=Object.create(null);globalObj.transition=400;document.body.onload=function(){mainGlobalFunc()};// --- functions ---
function mainGlobalFunc(){// --- page elements ---
globalObj.page=document.getElementsByClassName("pageContainer")[0];globalObj.pageReturnArea=document.getElementsByClassName("pageReturnArea")[0];var mainMenuContainer=document.getElementsByClassName("mainMenu")[0];var mainMenuBtn=document.getElementsByClassName("mainMenuBtn")[0];var sectionNavContainer=document.getElementsByClassName("sectionNavContainer")[0];var sectionsContainer=document.getElementsByClassName("sectionsContainer")[0];globalObj.sections=Array.from(sectionsContainer.children).filter(function(val){return val.nodeName==="SECTION"});var pageControls=document.getElementsByClassName("pageControls")[0];// --- main menu ---
createMainMenuEntries(globalObj.sections,mainMenuContainer,mainMenuBtn,globalObj.pageReturnArea);globalObj.mainMenuElements=Array.from(document.getElementsByClassName("mainMenuElement"));// --- section nav ---
createSectionPoints(globalObj.sections,sectionNavContainer);// --- page controls ---
pageControls.addEventListener("click",pageControlFunc);// --- scrolling events ---
document.addEventListener("wheel",wheelEventFunc);globalObj.page.addEventListener("touchstart",function(outerEvent){if(outerEvent.touches.length==1){page.addEventListener("touchend",touchendEvent)}function touchendEvent(innerEvent){page.removeEventListener("touchend",touchendEvent);var xChange=innerEvent.changedTouches[0].clientX-outerEvent.changedTouches[0].clientX;var yChange=(innerEvent.changedTouches[0].clientY-outerEvent.changedTouches[0].clientY)*-1;swipeAction(innerEvent.timeStamp-outerEvent.timeStamp,xChange,yChange,outerEvent.target)}});// --- start section ---
globalObj.pageSection={previous:0,current:0};globalObj.busy=false;activatePage(0);// --- slider init ---
sliderInit()}function sliderInit(){globalObj.sliderBusy=false;globalObj.sliderClasses=["sliderItem_left","sliderItem_center","sliderItem_right"];globalObj.sliderContainer=document.getElementsByClassName("sliderContent")[0];globalObj.sliderEntries=Array.from(globalObj.sliderContainer.children);globalObj.sliderLength=globalObj.sliderEntries.length;globalObj.sliderCurIdx=1;for(var i=3,n=globalObj.sliderEntries.length;i<n;++i){globalObj.sliderEntries[i].remove()}nodesAddClasses(globalObj.sliderContainer.children,globalObj.sliderClasses)}function sliderAction(str){if(!globalObj.sliderBusy){var directionIsLeft=true;if(str[0].toLowerCase()==="r"){directionIsLeft=false}else if(str[0].toLowerCase()!=="l"){throw new Error("Wrong slider action direction")}nodesRemoveClasses(globalObj.sliderContainer.children,globalObj.sliderClasses);var addIdx=formatIdx(globalObj.sliderCurIdx+2*(directionIsLeft?-1:1),globalObj.sliderLength);var insertNode=directionIsLeft?globalObj.sliderContainer.children[0]:null;globalObj.sliderContainer.insertBefore(globalObj.sliderEntries[addIdx],insertNode);nodesAddClasses(Array.from(globalObj.sliderContainer.children).slice(1,3),globalObj.sliderClasses.slice(directionIsLeft?1:0,3));console.log("--------");console.log(directionIsLeft);if(directionIsLeft){globalObj.sliderContainer.children[0].classList.add(["sliderItem_offscreenLeft","sliderItem_offscreenRight"][0]);globalObj.sliderContainer.children[3].classList.add("sliderItem_right")}else{globalObj.sliderContainer.children[3].classList.add(["sliderItem_offscreenLeft","sliderItem_offscreenRight"][1]);globalObj.sliderContainer.children[0].classList.add(["sliderItem_offscreenLeft","sliderItem_offscreenRight"][0])}window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){if(directionIsLeft){globalObj.sliderContainer.children[3].classList.add(["sliderItem_offscreenLeft","sliderItem_offscreenRight"][1]);globalObj.sliderContainer.children[3].classList.remove("sliderItem_right");nodesAddClasses(Array.from(globalObj.sliderContainer.children).slice(0,1),globalObj.sliderClasses.slice(0,1))}else{nodesAddClasses(Array.from(globalObj.sliderContainer.children).slice(3),globalObj.sliderClasses.slice(2))}setTimeout(function(){globalObj.sliderContainer.children[directionIsLeft?3:0].classList.remove(["sliderItem_offscreenLeft","sliderItem_offscreenRight"][directionIsLeft?1:0]);globalObj.sliderContainer.children[directionIsLeft?0:3].classList.remove(["sliderItem_offscreenLeft","sliderItem_offscreenRight"][directionIsLeft?0:1]);var removeIdx=directionIsLeft?globalObj.sliderContainer.children.length-1:0;globalObj.sliderContainer.children[removeIdx].remove();globalObj.sliderCurIdx=formatIdx(globalObj.sliderCurIdx+1*(directionIsLeft?-1:1),globalObj.sliderEntries.length);globalObj.sliderBusy=false},globalObj.transition)})})}globalObj.sliderBusy=true}function nodesAddClasses(nodes,classes){for(var i=0;i<classes.length&&i<nodes.length;++i){nodes[i].classList.add(classes[i])}}function nodesRemoveClasses(nodes,classes){for(var i=0;i<classes.length&&i<nodes.length;++i){nodes[i].classList.remove(classes[i])}}function pageControlFunc(event){if(scrollIsUp(event.target)){var pageId=formatIdx(globalObj.pageSection.current-1,globalObj.sections.length);scrollToPage(pageId)}else{var _pageId=formatIdx(globalObj.pageSection.current+1,globalObj.sections.length);scrollToPage(_pageId)}event.stopPropagation;function scrollIsUp(target){if(target.nodeName==="IMG"){return target.classList.contains("pageControlBtn__img_up")}else{return target.firstChild.classList.contains("pageControlBtn__img_up")}}}function swipeAction(time,xChange,yChange,target){var length=Math.sqrt(Math.pow(xChange,2)+Math.pow(yChange,2));var angle=calcPathAngle(xChange,yChange);if(target.classList.contains("pageReturnArea"))return;if(time>50&&length>10&&angle!==null){if(angle>=Math.PI/4&&angle<=3*Math.PI/4){var pageId=formatIdx(globalObj.pageSection.current+1,sections.length);scrollToPage(pageId)}else if(angle>=5*Math.PI/4&&angle<=7*Math.PI/4){var _pageId2=formatIdx(globalObj.pageSection.current-1,sections.length);scrollToPage(_pageId2)}}}function calcPathAngle(x,y){var tmp=Math.atan2(y,x);if(x===0&&y===0)return null;if(tmp<0)return Math.PI+(Math.PI-tmp*-1);return tmp}function scrollToPage(id){if(typeof id==="string"){id=globalObj.sections.indexOf(globalObj.sections.filter(function(val){return val.dataset.name===id})[0])}if(!globalObj.busy){if(globalObj.pageSection.current===id)return;globalObj.busy=true;var headerBtn=document.getElementsByClassName("headerBtn")[0];var animationIsDownwards=globalObj.pageSection.current-id===1||id===globalObj.sections.length-1&&globalObj.pageSection.current===0;deactivatePage(globalObj.pageSection.current,animationIsDownwards);activatePage(id,animationIsDownwards);if(id!==0){headerBtn.classList.remove("inactive");window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){headerBtn.classList.add("headerBtn_visible")})})}else{headerBtn.classList.remove("headerBtn_visible");setTimeout(function(){headerBtn.classList.add("inactive")},globalObj.transition)}globalObj.pageSection.previous=globalObj.pageSection.current;globalObj.pageSection.current=id;setTimeout(function(){globalObj.busy=false},globalObj.transition)}globalObj.busy=true}function activatePage(id,animationIsDownwards){toggleNavigationEntries(id);var page=globalObj.sections[id];var animationClass=animationIsDownwards?"pageSection_above":"pageSection_below";page.classList.add(animationClass);page.classList.add("pageSection_active");setTimeout(function(){page.classList.remove(animationClass)},50)}function deactivatePage(id,animationIsDownwards){toggleNavigationEntries(id);var page=globalObj.sections[id];var animationClass=animationIsDownwards?"pageSection_below":"pageSection_above";page.classList.add(animationClass);page.classList.remove("pageSection_active");setTimeout(function(){page.classList.remove(animationClass)},globalObj.transition)}function toggleNavigationEntries(id){var mainMenuEntry=globalObj.mainMenuElements[id];var sectionNavLPContainer=document.getElementsByClassName("sectionNavLinePointContainer_active")[id];sectionNavLPContainer.firstChild.classList.toggle("sectionNavLinePoint_selected");sectionNavLPContainer.lastChild.classList.toggle("sectionName_nameShown");mainMenuEntry.classList.toggle("mainMenuElement_current")}function formatIdx(idx,arrLength){if(idx<0)return arrLength+idx;return idx%arrLength}function createElementWithClasses(element){var local=document.createElement(element);if((arguments.length<=1?0:arguments.length-1)>0){for(var i=0;i<(arguments.length<=1?0:arguments.length-1);++i){local.classList.add(i+1<1||arguments.length<=i+1?undefined:arguments[i+1])}}return local}function adjustNumLength(num,length){var str=String(num);if(str.length<length){while(str.length<length){str="0"+str}}else{str=str.slice(str.length-length)}return str}function mainMenuViewToggle(event){var mainMenuElements=globalObj.mainMenuElements;var isOpeningAnimation=globalObj.page.classList.toggle("pageContainer_zoomedOut");setTimeout(function(){globalObj.pageReturnArea.classList.toggle("inactive")},isOpeningAnimation?0:globalObj.transition);var transitionDelayCf=isOpeningAnimation?0.05:0.02;for(var i=0;i<mainMenuElements.length;++i){mainMenuElements[i].style.transitionDelay="".concat((isOpeningAnimation?i:mainMenuElements.length-i-1)*transitionDelayCf,"s")}mainMenuElements.map(function(element){element.classList.toggle("mainMenuElement_appear")});if(event)event.stopPropagation}function wheelEventFunc(event){if(event.deltaY<0){var pageId=formatIdx(globalObj.pageSection.current-1,globalObj.sections.length);scrollToPage(pageId)}else if(event.deltaY>0){var _pageId3=formatIdx(globalObj.pageSection.current+1,globalObj.sections.length);scrollToPage(_pageId3)}event.preventDefault}function createMainMenuEntries(entriesSource,container){var list=document.createElement("ul");for(var i=0;i<entriesSource.length;++i){var entry=entriesSource[i];var menuElement=createElementWithClasses("li","mainMenuElement");menuElement.textContent=entry.dataset.name;menuElement.dataset.idx=i;menuElement.addEventListener("click",mainMenuClickFunc);list.appendChild(menuElement)}container.appendChild(list);for(var _len=arguments.length,menuButtons=new Array(_len>2?_len-2:0),_key=2;_key<_len;_key++){menuButtons[_key-2]=arguments[_key]}for(var _i=0;_i<menuButtons.length;_i++){var button=menuButtons[_i];button.addEventListener("click",mainMenuViewToggle)}}function createSectionPoints(entriesSource,container){var sectionNavLinePointContainer=createElementWithClasses("div","sectionNavLinePointContainer");var sectionNavLinePoint=createElementWithClasses("div","sectionNavLinePoint");sectionNavLinePointContainer.appendChild(sectionNavLinePoint.cloneNode());for(var i=0;i<entriesSource.length;++i){var containerCopy=sectionNavLinePointContainer.cloneNode({deep:true});containerCopy.firstChild.classList.add("sectionNavLinePoint_active");containerCopy.classList.add("sectionNavLinePointContainer_active");var sectionName=createElementWithClasses("div","sectionName");var numberSpan=createElementWithClasses("span","sectionName__number");numberSpan.textContent=adjustNumLength(i+1,2);numberSpan.dataset.idx=i;numberSpan.addEventListener("click",sectionPointClickEvent);var nameSpan=createElementWithClasses("span","sectionName__name");nameSpan.textContent=entriesSource[i].dataset.name;sectionName.appendChild(numberSpan);sectionName.appendChild(nameSpan);containerCopy.appendChild(sectionName);container.appendChild(containerCopy);if(i<entriesSource.length-1){for(var _i2=0;_i2<3;++_i2){container.appendChild(sectionNavLinePointContainer.cloneNode({deep:true}))}}}}function sectionPointClickEvent(event){var id=Number(event.target.dataset.idx);if(event.target.parentElement.classList.contains("sectionName_nameShown")){return}scrollToPage(id)}function mainMenuClickFunc(event){var id=Number(event.target.dataset.idx);if(event.target.classList.contains("mainMenuElement_current"))return;mainMenuViewToggle();setTimeout(function(){scrollToPage(id)},200)}

//# sourceMappingURL=main.min.js.map